<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Coroutines</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
    margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-default_background {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 237, 214, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 237, 214, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-uiBlue { background-color: rgba(35, 131, 226, .07); }
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-transparentGray { background-color: rgba(227, 226, 224, 0); }
.select-value-color-translucentGray { background-color: rgba(0, 0, 0, 0.06); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(249, 228, 188, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }
.select-value-color-pageGlass { background-color: undefined; }
.select-value-color-washGlass { background-color: undefined; }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="98617e8e-3707-4c28-985e-7d8a537f5545" class="page sans"><header><img class="page-cover-image" src="Coroutines%2098617e8e37074c28985e7d8a537f5545/cover-kotlin-coroutines.webp" style="object-position:center 50%"/><div class="page-header-icon page-header-icon-with-cover"><img class="icon" src="Coroutines%2098617e8e37074c28985e7d8a537f5545/icon-kotlin.svg"/></div><h1 class="page-title"><strong>Coroutines</strong></h1><p class="page-description"></p></header><div class="page-body"><figure id="4f959874-85c7-4f06-8131-240fd59b27b7" class="link-to-page"><a href="Coroutines%2098617e8e37074c28985e7d8a537f5545/Flow%204f95987485c74f068131240fd59b27b7.html"><img class="icon" src="Coroutines%2098617e8e37074c28985e7d8a537f5545/Flow%204f95987485c74f068131240fd59b27b7/icon-kotlin.svg"/>Flow</a></figure><figure id="c9386b14-c3ce-40b6-8329-8b81516b7544" class="link-to-page"><a href="Coroutines%2098617e8e37074c28985e7d8a537f5545/Channels%20c9386b14c3ce40b683298b81516b7544.html"><img class="icon" src="Coroutines%2098617e8e37074c28985e7d8a537f5545/Channels%20c9386b14c3ce40b683298b81516b7544/icon-kotlin.svg"/>Channels</a></figure><figure id="37b84409-48d7-4f50-bb95-9b76ad0209fc" class="link-to-page"><a href="Coroutines%2098617e8e37074c28985e7d8a537f5545/Cases%2037b8440948d74f50bb959b76ad0209fc.html"><img class="icon" src="Coroutines%2098617e8e37074c28985e7d8a537f5545/Cases%2037b8440948d74f50bb959b76ad0209fc/icon-kotlin.svg"/>Cases</a></figure><hr id="27598893-f976-4f31-9681-fc9a0ad191b7"/><table id="58f4ed0c-61b1-4602-8db3-29994669c645" class="simple-table"><tbody><tr id="5c05de4c-1a55-4142-8ced-4dad7ef16b56"><td id="eKr?" class="" style="width:595px"><a href="https://developer.android.com/kotlin/coroutines">https://developer.android.com/kotlin/coroutines</a></td></tr><tr id="425df62f-15d0-48a8-808d-cb9eedff0f50"><td id="eKr?" class="" style="width:595px"><a href="https://developer.android.com/topic/libraries/architecture/coroutines">https://developer.android.com/topic/libraries/architecture/coroutines</a></td></tr><tr id="d440ea95-2b5c-4ba3-8082-8d4ef905ae36"><td id="eKr?" class="" style="width:595px"><a href="https://developer.android.com/kotlin/coroutines/coroutines-best-practices">https://developer.android.com/kotlin/coroutines/coroutines-best-practices</a></td></tr><tr id="1dab64cb-4c51-4596-8dea-f9e8c37df884"><td id="eKr?" class="" style="width:595px"><a href="https://d.android.com/kotlin/coroutines/coroutines-adv">https://d.android.com/kotlin/coroutines/coroutines-adv</a></td></tr><tr id="a35377d2-671f-4f92-9392-44ce12387c9c"><td id="eKr?" class="" style="width:595px"><a href="https://d.android.com/kotlin/coroutines#features">https://d.android.com/kotlin/coroutines#features</a></td></tr></tbody></table><table id="d4ddff36-0682-4ae3-a160-970ce82881ab" class="simple-table"><tbody><tr id="c7c1f7ed-959b-47be-aa61-e5bd8e865bb8"><td id="eKr?" class="" style="width:278px"><a href="https://kotlinlang.org/docs/coroutines-guide.html">https://kotlinlang.org/docs/coroutines-guide.html</a></td></tr></tbody></table><table id="8d7b9c57-808f-4341-a7f4-a821d69312c2" class="simple-table"><tbody><tr id="bcff532a-8551-4cd3-9260-25cd3f0be64f"><td id="SLmt" class="" style="width:102px"><mark class="highlight-brown"><code>21.01.2023</code></mark></td><td id="eKr?" class="" style="width:593px"><a href="https://youtu.be/ITLe4FIrrTg">https://youtu.be/ITLe4FIrrTg</a></td></tr><tr id="9e8fe071-6e8b-4959-830c-03a7759ed02a"><td id="SLmt" class="" style="width:102px"><mark class="highlight-brown"><code>28.09.2022</code></mark></td><td id="eKr?" class="" style="width:593px"><a href="https://youtu.be/L04cpMbNQ10">https://youtu.be/L04cpMbNQ10</a></td></tr><tr id="d38b55d5-d902-47b8-856c-1db8bcde2dce"><td id="SLmt" class="" style="width:102px"><mark class="highlight-brown"><code>24.05.2022</code></mark></td><td id="eKr?" class="" style="width:593px"><a href="https://youtu.be/arUctP5yAYc">https://youtu.be/arUctP5yAYc</a></td></tr><tr id="759857b6-d691-4fb9-821d-31f381a3be5b"><td id="SLmt" class="" style="width:102px"><mark class="highlight-brown"><code>24.05.2022</code></mark></td><td id="eKr?" class="" style="width:593px"><a href="https://www.youtube.com/playlist?list=PL0SwNXKJbuNmsKQW9mtTSxNn00oJlYOLA">https://www.youtube.com/playlist?list=PL0SwNXKJbuNmsKQW9mtTSxNn00oJlYOLA</a></td></tr></tbody></table><table id="ca4f0b49-bab9-43bc-a7ac-bb99ace60980" class="simple-table"><tbody><tr id="2846afce-c6ff-4ee0-acba-474cb2f8acf3"><td id="B|Ly" class="" style="width:101px"><mark class="highlight-brown"><code>27.08.2024</code></mark></td><td id="mMoP" class="" style="width:352px"><a href="https://habr.com/ru/articles/838974/">https://habr.com/ru/articles/838974/</a></td></tr><tr id="7f8b1ebd-fa85-4907-b369-0ef6e8022aee"><td id="B|Ly" class="" style="width:101px"><mark class="highlight-brown"><code>11.07.2024</code></mark></td><td id="mMoP" class="" style="width:352px"><a href="https://habr.com/ru/articles/827866/">https://habr.com/ru/articles/827866/</a></td></tr></tbody></table><h3 id="f87d6e1c-5ea6-4ce9-a497-955a010dab63" class=""><strong>Coroutines</strong></h3><p id="f260a7c0-37f3-43cc-8645-5dadf695f4df" class="">API для асинхронных операций, которые могут быть приостановлены.</p><p id="1a6c519d-99e8-4578-be48-a1de826dbd04" class="">• созданы для асинхронных операций (потоки - для многозадачности).</p><p id="89139b9b-b904-4ed7-b37b-f6ab8e88a4c2" class="">• возможность писать асинхронный код в синхронном стиле.</p><p id="45ac39d3-b1f7-4df0-af43-394a3a4e25ac" class="">• когда корутина приостанавливается - она освобождает поток, когда она готова - найдет первый свободный поток и продолжит работу.</p><p id="e7054779-2e84-4e04-922b-dc60c3e220f3" class="">• не гарантируется выполнение на одном и том же потоке.</p><p id="92dab9c3-8aee-4b82-b61d-b902390d41a3" class="">
</p><h3 id="67bef53b-6057-478c-94e3-57962b73ad1a" class=""><code>yield</code></h3><p id="729c337a-5c6d-4565-aa0f-4a8aa5b73459" class="">Вызывается для проверки статуса отмены корутины. Уступить поток (или пул потоков) текущей корутины чтобы позволить другим корутинам работать на том же потоке (или пуле потоков).</p><p id="e7617a07-6fa6-4434-99b9-2056646e61e3" class="">Здесь мы запускаем две корутины, каждая из которых вызывает функцию <code>yield</code>, чтобы позволить другой корутине работать в потоке <code>main</code>. Мы видим вывод первой корутины, после чего она вызывает команду <code>yield</code>. Это приостанавливает работу первой корутины и позволяет выполняться второй. Аналогичным образом вторая корутина также вызывает функцию <code>yield</code> и позволяет первой корутине возобновить выполнение.</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="8b20649c-13f9-4906-9294-4be6f77d35b7" class="code"><code class="language-Kotlin" style="white-space:pre-wrap;word-break:break-all">fun main() = runBlocking{
    try {
        val job1 = launch {
            repeat(20) {
                println(&quot;processing job 1: ${Thread.currentThread().name}&quot;)
                yield()
            }
        }
        val job2 = launch {
            repeat(20) {
                println(&quot;processing job 2: ${Thread.currentThread().name}&quot;)
                yield()
            }
        }
        job1.join()
        job2.join()
    } catch (e: CancellationException) {
        // код очистки
    }
}

processing job 1: main
processing job 2: main
processing job 1: main
processing job 2: main
processing job 1: main</code></pre><p id="0b20303b-40fc-4ca3-ad98-89aedf8c7d95" class="">
</p><h3 id="dc0dc424-9582-4062-b1a2-1f3f257ab7a3" class=""><code><strong>newSingleThreadContext</strong></code></h3><p id="93f50bda-9808-4667-bcf1-da6f3ca73d74" class="">Вручную запускает поток с указанным именем. API деликатное, использовать осторожно.</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="aa796925-e914-4f72-abbc-50b39da2b2d2" class="code"><code class="language-Kotlin" style="white-space:pre-wrap;word-break:break-all">launch(newSingleThreadContext(&quot;Custom Thread&quot;)) {
    println(&quot;coroutine flow: ${Thread.currentThread().name}&quot;)&quot;}</code></pre><p id="cd58e747-81ca-4f27-a0d5-5e519ddb22dd" class="">
</p><h3 id="f9ca95ee-67a5-4519-b701-cdf4874b9fc8" class=""><code><strong>newFixedThreadPoolContext</strong></code></h3><p id="57b1c81a-ae7d-4c22-9cc3-871338cc8166" class="">Позволяет создать собственный отдельный пул потоков. Все корутины по умолчанию выполняются в CommonPool. Все ресурсы будут освобождены после того как программа отработает. API деликатное, использовать осторожно.</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="336b9c2a-5716-498c-b811-a1712fadf832" class="code"><code class="language-Kotlin" style="white-space:pre-wrap;word-break:break-all">val pool: ExecutorCoroutineDispatcher = newFixedThreadPoolContext(8, &quot;myPool&quot;)</code></pre><details open=""><summary style="font-weight:600;font-size:1.25em;line-height:1.3;margin:0">Builders</summary><div class="indented"><h3 id="63f08989-fd9d-4e1d-a305-f959945ea325" class=""><code><strong>launch</strong></code></h3><p id="5724b9cb-9edc-44e5-9530-0750dca67612" class="">Функция, запускающая новую корутину в заданном контексте, которая не блокирует текущий поток и возвращает объект <code>Job</code>, позволяющий управлять выполнением корутины. Выстрелил и забыл.</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="10315285-0ae8-80d7-aa27-e77f9966b7f5" class="code"><code class="language-Kotlin">// корутина запускается в рамках runBlocking и выполняется асинхронно, а job.join() ожидает её завершения.
fun main() = runBlocking {
    val job = launch {
		    // Код корутины
        delay(1000)
        println(&quot;Hello from coroutine!&quot;)
    }

    job.join()  // Ожидание завершения корутины
}</code></pre><p id="10315285-0ae8-80fe-a691-cd5a4c54af49" class="">
</p><h3 id="87121022-cf61-4f00-85cd-b98a360ed874" class=""><code><strong>async</strong></code></h3><p id="10315285-0ae8-80d2-8c7f-d63b29b58222" class="">Функция, которая запускает новую корутину и возвращает объект <code>Deferred</code>, позволяющий получить результат выполнения корутины в будущем. Позволяет использовать функцию <code>await()</code> для получения результата, который будет доступен после завершения корутины.</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="10315285-0ae8-80ce-839b-d62d6e1a63a6" class="code"><code class="language-Kotlin">// async запускает корутину, возвращающую значение 42, и мы используем await() для получения этого значения после её завершения.
fun main() = runBlocking {
    val deferred: Deferred&lt;Int&gt; = async {
        // Код корутины, возвращающей результат
        delay(1000)
        42
    }

    val result = deferred.await()  // Ожидание завершения корутины и получение результата
    println(&quot;The result is $result&quot;)
}</code></pre><p id="e99a955d-d0f0-4d37-ac5b-863596517d34" class="">
</p><h3 id="b607b599-65c2-42ab-b9da-033806ddb597" class=""><code><strong>await</strong></code></h3><p id="10315285-0ae8-8071-a708-da90400efaf4" class="">Используется в корутинах для ожидания завершения корутины, запущенной с помощью <code>async</code>.</p><p id="203354d2-395c-4f7d-961d-ed2d99baf8b8" class="">
</p><h3 id="10315285-0ae8-80e0-8e62-e61f096db3e1" class=""><mark class="highlight-red"><code>Deferred</code></mark></h3><p id="10315285-0ae8-8043-846a-f4465cfb7f47" class="">Представляет собой задачу, результат которой будет доступен в будущем. Это значение, которое ещё не вычислено, но будет доступно после завершения асинхронной операции. Обычно создаётся с помощью функции <code>async</code>.</p></div></details><details open=""><summary style="font-weight:600;font-size:1.25em;line-height:1.3;margin:0">Structures cuncurrency</summary><div class="indented"><p id="816ee16d-2190-4db4-81e4-2f4143f7bab6" class="">Механизм, предоставляющий иерархическую структуру для организации работы coroutine. Все принципы строятся на основе CoroutineScope и оношения родитель-ребенок у <code>Job</code>.</p><p id="6307437d-2818-4c06-99e9-7b2b923c8c6b" class="">• scope хранит все ссылки на coroutines, запущенные в нем.</p><p id="8719f257-2c36-4623-aade-004de8ff7bbf" class="">• отмена scope - отмена coroutines.</p><p id="df251d00-7aa4-4202-b99e-eebbdbf3a0d9" class="">• отмена родительской <code>Job</code> приведет к отмене всех дочерних <code>Job</code>.</p><p id="b601f3d6-e659-4b4f-bd10-3523d3a16e39" class="">• отмена дочерней <code>Job</code> приведет к отмене родительской <code>Job</code> и отмене всех других дочерних <code>Job</code>.</p><p id="04497f5c-261f-4e16-a534-fe2ea2ccb92c" class="">
</p></div></details><details open=""><summary style="font-weight:600;font-size:1.25em;line-height:1.3;margin:0">Синхронизация</summary><div class="indented"><h3 id="33a0bb4a-0708-496c-becf-975ac1121b87" class=""><code><strong>Mutex</strong></code></h3><p id="a8620f94-9307-4426-b22c-1ef83e74322a" class="">Механизм синхронизации, который позволяет управлять доступом к разделяемым ресурсам между корутинами. Он блокирует доступ к ресурсу, пока один поток или корутина его не освободит.</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="0154656c-89f5-42a6-9e82-2713db8bfba4" class="code"><code class="language-Kotlin">val mutex = Mutex()

suspend fun criticalSection() {
    mutex.withLock {
        // Код, который должен быть выполнен эксклюзивно
    }
}</code></pre></div></details><details open=""><summary style="font-weight:600;font-size:1.25em;line-height:1.3;margin:0"><code>Job</code></summary><div class="indented"><p id="0d0b09ba-042c-4bcd-ab17-8bfe1e0477f5" class="">Основной механизм управления корутинами в Kotlin, который позволяет эффективно управлять жизненным циклом корутин, их отменой и композицией.</p><p id="43a78865-297a-4d42-8077-09c9bc1514bf" class="">• Когда вы запускаете корутину с помощью функций launch или async, возвращается объект Job, который представляет корутину.</p><p id="302f375c-33e3-4437-98e6-bfb52ef29a95" class="">• На основе Job можно организовать иерархию parent-child.</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="f090c23e-d76e-4633-9e3d-60cb5f557615" class="code"><code class="language-Kotlin">fun main() = runBlocking {
    val job: Job = launch {
        // Код корутины
        delay(1000)
        println(&quot;Coroutine finished&quot;)
    }

    // Ожидание завершения корутины
    job.join()
    println(&quot;Main program finished&quot;)
}</code></pre><p id="56aaa753-9a4a-4e4d-8d62-1723a039cf02" class="">
</p><h3 id="061c1bf0-25cd-4929-85e2-0806e530ee8b" class=""><code><strong>SupervisorJob</strong></code></h3><p id="5f0d4a28-fee1-41b3-9f8e-46e23a060134" class="">Специальный тип Job в Kotlin Coroutines, который используется для создания корутин, не зависимых друг от друга. В отличие от обычного Job, который отменяет все дочерние корутины при отмене или ошибке одной из них, SupervisorJob позволяет дочерним корутинам продолжать работу, даже если одна из них завершится с ошибкой.</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="3360dfcc-e18d-448e-bccd-d303a3b01e59" class="code"><code class="language-Kotlin">fun main() = runBlocking {
    val supervisor = SupervisorJob()
    
    val scope = CoroutineScope(Dispatchers.Default + supervisor)

    val child1 = scope.launch {
        println(&quot;Child 1 started&quot;)
        throw RuntimeException(&quot;Error in Child 1&quot;)
    }

    val child2 = scope.launch {
        println(&quot;Child 2 started&quot;)
        delay(1000)
        println(&quot;Child 2 finished&quot;)
    }

    child1.join() // Ожидание завершения Child 1
    child2.join() // Ожидание завершения Child 2

    println(&quot;Main program finished&quot;)
}</code></pre><p id="702947c1-88da-4ec4-8c1e-da3700a21a3b" class="">
</p><h3 id="b1910597-21d8-49a6-a1ab-3451edd8bf5a" class="">Lifecycle</h3><p id="4eca954d-1993-4f00-bdea-62b0495396fb" class="">• <code>New</code> Корутина создана, но ещё не запущена.</p><p id="85eba04b-d97d-47ce-af12-f4ca9ed705e6" class="">• <code>Active</code> Корутина запущена и выполняется.</p><p id="2484da5c-9c9c-4673-9737-e11dbde4f172" class="">• <code>Completing</code> Корутина завершается.</p><p id="86218325-c369-499c-ac7d-be281055db7f" class="">• <code>Completed</code> Корутина успешно завершилась без ошибок.</p><p id="75eb5559-bd1d-479e-a127-af2ac4abd414" class="">• <code>Cancelling</code> Корутина отменяется.</p><p id="bccaebc2-1bfc-452a-9e7c-c010f29ff89b" class="">• <code>Canceled</code> Корутина была отменена до завершения (вызван метод <code>cancel</code> у <code>Job</code>)</p><p id="bd66d9ce-c80a-4fb1-956f-2a10aa882028" class="">
</p><h3 id="e96d1494-435b-4c40-81a6-91c3d3104f39" class=""><code>start</code></h3><p id="8c5c6491-4266-4b2e-bd96-b7a8536b4d46" class="">Запускает корутину, если она ещё не запущена.</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="ff68a3fd-c57d-477f-8550-7a54a9e294b0" class="code"><code class="language-Kotlin">val job = GlobalScope.launch { /* корутина */ }
job.start() // Явный запуск корутины</code></pre><p id="487ce618-293e-4779-aa28-92911fe51431" class="">
</p><h3 id="2fb209bb-0080-45dd-ba34-d66cc9e979cc" class=""><code>join</code></h3><p id="70e498f7-96c1-48da-b9f5-662aeadc5da8" class="">Блокирует текущий поток до тех пор, пока корутина не завершится.</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="76e274ed-2446-4fb0-8041-a0c9bf9db2d1" class="code"><code class="language-Kotlin">val job = GlobalScope.launch { /* корутина */ }
job.join() // Ожидание завершения корутины</code></pre><p id="8aa43517-69be-4da8-b3e0-6ffb4bd5681b" class="">
</p><h3 id="b4746b48-874a-4768-8baf-5dcb1f11b1ed" class=""><code>cancel</code></h3><p id="2f597708-1104-4237-ad18-851b823ec63a" class="">Отменяет выполнение корутины.</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="11e070fd-37f1-4a9b-b404-6bd72b4c2e4f" class="code"><code class="language-Kotlin">val job = GlobalScope.launch { /* корутина */ }
job.cancel() // Отменяет корутину</code></pre><p id="1767f21a-edbf-40f4-92a9-482e67abbf80" class="">
</p><h3 id="e0dbac3d-b46a-4b63-91fa-6ba90f33e89e" class=""><code>cancelAndJoin</code></h3><p id="c63822db-633f-484f-bfe7-f30d82a68874" class="">Отменяет выполнение корутины и ожидает её завершения.</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="54c32161-15ed-4720-be8e-2a98a65b684d" class="code"><code class="language-Kotlin">val job = GlobalScope.launch { /* корутина */ }
job.cancelAndJoin() // Отмена корутины и ожидание её завершения</code></pre><p id="8db1824e-bf4f-4e6b-b289-c7ea80546b66" class="">
</p><h3 id="e4c9a320-d839-42e4-97d7-37cbfc9a16a4" class=""><code>isActive</code></h3><p id="a838258a-8897-4d28-9b0e-9480d2901843" class="">Проверяет, активна ли корутина (т.е., она запущена и не отменена).</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="4256989e-e47b-423e-a07f-295bd96471e7" class="code"><code class="language-Kotlin">val job = GlobalScope.launch { /* корутина */ }
if (job.isActive) { /* корутина активна */ }</code></pre><p id="42da8ef7-5d0e-46ca-89a8-479731caca01" class="">
</p><h3 id="1856144a-5220-48d2-a99c-8eeb5bdc3258" class=""> <code>isCancelled</code></h3><p id="ba55b481-6dd2-4579-a8d9-a8c643601ad6" class="">Проверяет, была ли корутина отменена.</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="08d6b4dd-a6cc-45c1-a734-ce12cd470e18" class="code"><code class="language-Kotlin">val job = GlobalScope.launch { /* корутина */ }
if (job.isCancelled) { /* корутина отменена */ }</code></pre><p id="d640dc09-c755-443c-9c5e-81e8615ef512" class="">
</p><h3 id="98483756-10f8-49bb-bfd2-36e5c980eb08" class=""><code>isCompleted</code></h3><p id="f6f7832d-2f9b-4178-a67d-58a413e3e953" class="">Проверяет, завершена ли корутина (успешно или из-за ошибки).</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="7824e585-2b8d-44e2-946a-f4dc57d62cb8" class="code"><code class="language-Kotlin">val job = GlobalScope.launch { /* корутина */ }
if (job.isCompleted) { /* корутина завершена */ }</code></pre><p id="2cc20502-ac10-4f7d-8b68-b59927aca4dc" class="">
</p><h3 id="14cdaedf-8a23-45c5-85ce-e4f0b5e2b7f6" class=""><code>invokeOnCompletion</code></h3><p id="c0166808-8b68-4d5c-a670-f04ba211a4e2" class="">Устанавливает обработчик, который будет вызван, когда корутина завершится.</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="55000fd2-58ef-4b57-8a9d-05b23e26bb54" class="code"><code class="language-Kotlin">val job = GlobalScope.launch { /* корутина */ }
job.invokeOnCompletion { 
    // Код, выполняемый после завершения корутины
}</code></pre></div></details><details open=""><summary style="font-weight:600;font-size:1.25em;line-height:1.3;margin:0">Context</summary><div class="indented"><h3 id="f6fa76e5-8766-4e4a-800a-42fefc829826" class=""><code><strong>CoroutineContext</strong></code></h3><p id="d717b1a0-9e6a-4673-a724-dafa102c2aa0" class="">Определяет поведение корутины. Является набором параметров для выполнения coroutines. </p><p id="0c4c92fc-58b9-451d-bee9-1253f36a7224" class="">• каждая корутина выполняется в каком-либо контексте. </p><p id="781ac672-b168-4e10-8acc-100af457ca20" class="">• явно не создается, задается в scope либо при запуске корутины (в launch). </p><p id="f5829a29-a1b0-42e0-9253-49271c2a4c7a" class="">• можно объединить несколько контекстов в один</p><p id="3171481c-8f23-417a-826d-87b088a03b3b" class="">
</p><h3 id="54ebeaa1-bb10-4f09-a2bc-460210e96886" class=""><code><strong>withContext</strong></code></h3><p id="3ccf5809-36c3-4256-b1f4-b7a66dc55ab0" class="">Переносит выполнение текущей корутины на новый контекст, в большинстве случаев на новый диспетчер.</p></div></details><details open=""><summary style="font-weight:600;font-size:1.25em;line-height:1.3;margin:0">Scope</summary><div class="indented"><h3 id="c9cf3591-9e40-4c9f-8707-5eb6b55bf62c" class=""><code><strong>CoroutineScope</strong></code></h3><p id="f9cf0a0f-536c-4a63-a90d-be45403821fb" class="">Отслеживает любую корутину, которую создает, используя launch или async. Scope хранит все ссылки на корутины, запущенные в нем. Scope может отменить выполнение всех дочерних корутин, если возникнет ошибка или операция будет отменена.</p><p id="c1e08b70-ce88-4993-9e8d-f81e1664f4e5" class="">• отмена дочернего scope приведет к отмене родительского scope и наоборот.</p><p id="b3d26be9-9069-43ce-9a02-07ac8955619c" class="">• scope будет завершен успешно, когда выполнятся все корутины в нем.</p><p id="075b944e-e75a-4707-8c9e-32b92f321060" class="">• если запустить бесконечный цикл внутри scope и отменить его - цикл закончит выполнение.</p><p id="f2ad7b32-01c9-4b53-9b1c-e0ac2e9721bb" class="">
</p><h3 id="d264294a-0502-46b6-b51d-e5681a3cfcf7" class=""><code><strong>supervisorScope</strong></code></h3><p id="39ef20b0-ccaa-4357-82b2-5a3ab56543be" class="">Аналог <code>coroutineScope</code>. <code>SupervisorJob</code> для scope. Переопределяет <code><strong>Job</strong></code><strong> </strong>контекст, поэтому функция не отменяется, когда дочерний элемент выдает исключение.</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="aa691676-08f2-4cd8-b8a1-2e44519dee29" class="code"><code class="language-Kotlin" style="white-space:pre-wrap;word-break:break-all">supervisorScope {
    ...
}</code></pre><p id="0b36aba9-7cd6-476d-be07-9bfcfa19943e" class="">
</p><h3 id="2aabbedc-2271-49af-8e4b-7090224ecfc5" class=""><mark class="highlight-red"><code>withTimeout</code></mark></h3><p id="0340a80f-5e8f-4570-a0cb-6c20b0b7c3ba" class="">Устанавливает ограничение по времени для выполнения работы. Если время вышло - корутина отменится и вызовется <code>TimeoutCancellationException</code>.</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="752b342c-80db-4610-9130-ac61effd0329" class="code"><code class="language-Kotlin">withTimeout(1_000L) {
		...
}</code></pre><p id="b5692aea-f1ec-45e4-b499-0c41ff87ec0d" class="">
</p><h3 id="90b13631-23fc-4936-a3db-9fed92476480" class=""><code>withTimeoutOrNull</code></h3><p id="3bd8701e-7c14-4a38-9680-b0ddb6631394" class="">Устанавливает ограничение по времени для выполнения работы. Если время вышло вернет результат null.</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="c4b91fc8-f317-4912-9937-2f46dadf5b30" class="code"><code class="language-Kotlin">val result = withTimeoutOrNull(1_000L) {
		...
}</code></pre><p id="ed8d129c-fbd1-481a-9146-6692c377773d" class="">
</p><h3 id="15ebe75d-3618-4235-a90c-9d6be5a43bc3" class=""><code><strong>GlobalScope</strong></code></h3><p id="a28b252c-4042-42d5-a5d1-65096761f10f" class="">Специальный CoroutineScope, который не привязан к какай-либо Job. Все корутины, запущенные в рамках него будут работать до своей остановки или остановки процесса. Использование может легко привести к утечке памяти. </p><p id="8a382640-2a74-4b88-96c3-8ce439e4a85b" class="">• этот scope невозможно отменить. </p><p id="4688f947-146e-43d0-b0a3-9c9d5ae70be0" class="">• использование нарушает принципы structured concurrency и может привести к утечке памяти.</p><p id="7452fba6-5510-44f8-a21f-8ab711ee8a75" class="">
</p><h3 id="7fd5f0f9-d0c6-47b4-992d-723e45221c1c" class=""><code><strong>viewModelScope</strong></code></h3><p id="ebf1f440-073e-4a21-ad9b-440eda4a231b" class="">Отменяется при очистке <code>ViewModel</code>.</p><p id="ea572b72-c9eb-434f-af44-2aff90ae3afc" class="">
</p><h3 id="039bc084-3e41-4e0e-80aa-384d5d23fdab" class=""><code><strong>rememberCoroutineScope</strong></code></h3><p id="804fe49f-1e33-45d1-81d9-2a192ef37f46" class="">Отменяется когда компонуемый объект выходит из рекомпозиции.</p><p id="cf4b9d12-8322-4dee-b4d1-4169f16e8e66" class="">
</p><h3 id="125aaa5e-93d9-4d73-a257-36588cbfd79d" class=""><code><strong>viewLifecycleOwner.lifecycleScope</strong></code></h3><p id="f25b9727-2cdd-4296-8be6-97621ebbd3ff" class="">Отменяется по окончании жизненного цикла Android View.</p></div></details><details open=""><summary style="font-weight:600;font-size:1.25em;line-height:1.3;margin:0">Dispatchers</summary><div class="indented"><p id="e64f38a3-5a36-47df-ac2d-675ef4d72893" class="">Dispatcher - объект, который определяет, на каком потоке или пуле потоков будет выполняться корутина. Он управляет контекстом выполнения корутины, что позволяет эффективно распределять задачи и управлять ресурсами.</p><p id="0724058e-e624-4191-9f7f-e2a95b0488b9" class="">
</p><h3 id="05d03aea-298a-4251-8f98-6e8deff18399" class=""><code><strong>Dispatcher.Default</strong></code></h3><p id="0034fa88-a2c5-4845-9857-24d92f05a6ce" class="">Используется для выполнения корутин, требующих значительных вычислительных ресурсов.</p><p id="f51b82d4-75a2-4d85-8b66-23e4d32b33bc" class="">• Использует пул потоков, размер которого обычно соответствует числу доступных процессоров (или ядер).</p><p id="39d4b1f1-003f-4b64-9eca-6de45a4d9df7" class="">• Пул потоков автоматически масштабируется в зависимости от нагрузки.</p><p id="dcc79326-c0a3-41fa-bc3d-7b916ee89349" class="">• Не рекомендуется для I/O операций так как использует пул с ограниченным числом потоков, блокировка одного из этих потоков может снизить общую производительность приложения, особенно если таких операций много.</p><p id="e6a417d3-3056-4209-b209-6057210d830d" class="">• Используется по умолчанию в launch и async.</p><p id="84f8c3b6-999c-445f-b0f2-bd71a74bffe9" class="">• Ограничить количество потоков: <code>Dispatchers.Default.limitedParallelism(3)</code>.</p><p id="e142a18b-4d92-411b-8327-343616c0c3cc" class="">• Под капотом FixedThreadPool.</p><p id="32f9f5a5-d647-421b-845e-9f92452e9418" class="">
</p><h3 id="8289a5eb-486f-4fcc-996e-7bb5afe303b0" class=""><code><strong>Dispatcher.IO</strong></code></h3><p id="8b540aba-4d01-4478-a2e9-92633a7d3601" class="">Предназначен для выполнения операций ввода/вывода, таких как сетевые запросы и операции с файлами.</p><p id="3f5001c5-55e7-4ea6-aabd-44c84be41247" class="">• Пул потоков имеет динамический размер. Количество потоков может увеличиваться в зависимости от текущей нагрузки и количества ожидающих задач.</p><p id="b10fdd11-a603-410f-8722-624efebad0fd" class="">• Если все потоки заняты, новые задачи помещаются в очередь и обрабатываются по мере освобождения потоков.</p><p id="b091b415-acf2-474d-bbea-70eef0bf3597" class="">• Под капотом CachedThreadPool.</p><p id="034fe096-4645-44a4-8589-ea2e3a51ee34" class="">
</p><h3 id="f665016f-945b-460f-886f-6733d9f7baf6" class=""><code><strong>Dispatcher.Main</strong></code></h3><p id="004b34fd-8c40-41be-a45d-e73a3ef57a34" class="">Предназначен для работы с основным потоком пользовательского интерфейса в Android. Добавляет задачу в очередь MainLooper.</p><p id="5cb5f903-d9f0-48c1-bf22-df5eae4be89c" class="">
</p><h3 id="dc269fb1-2377-403b-9528-a143ff2dc5d5" class=""><code><strong>Dispatcher.Main.immediate</strong></code></h3><p id="45fa72a4-cb53-477e-bf7a-0bf102faa312" class="">Специальная версия Dispatchers.Main, которая предназначена для обеспечения немедленного исполнения корутин на основном потоке, если это возможно. Гарантирует, что корутины будут выполнены немедленно, если основной поток уже активен и готов к выполнению. Это полезно, когда требуется убедиться, что задачи на основном потоке выполняются как можно быстрее. Полезен, когда необходимо минимизировать задержку выполнения задач на основном потоке.</p><p id="d61596ce-9dd1-432b-b2b0-39b25c2e8e04" class="">
</p><h3 id="828d5808-c06d-4bce-aee0-4aa1e88061c4" class=""><code><strong>Dispatchers.Unconfined</strong></code></h3><p id="a6b6d079-d8dc-4a7e-a5d6-a7048c2bab51" class="">Не привязан к конкретному потоку или диспетчеру. Начинается выполнение корутины на текущем потоке, а затем продолжает выполнение в том контексте, где будет возобновлена корутина. Это означает, что выполнение может происходить на любом потоке или в любом контексте, где корутина будет приостановлена и возобновлена. Полезен для корутин, которые не требуют привязки к конкретному потоку или когда вам не важен поток, на котором корутина будет выполняться. Обычно он используется для тестирования или в случаях, когда выполнение корутины не зависит от потока.</p></div></details><details open=""><summary style="font-weight:600;font-size:1.25em;line-height:1.3;margin:0">Exceptions</summary><div class="indented"><h3 id="ab1cb4e5-8dbc-45c5-9963-b36cff5b707a" class=""><code><strong>CancellationException</strong></code><strong> </strong></h3><p id="ab91e597-0b23-4abd-ace7-516d72466b4f" class="">Специальное исключение для обработки отмены выполнения корутин<br/> • вызов cancel приведет к этому исключению<br/></p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2406d1d1-ef0f-4574-ad6d-b63402be68c3" class="code"><code class="language-Kotlin" style="white-space:pre-wrap;word-break:break-all">try {
    ...
} catch (e: CancellationException) {
    // обязательно пробрасываем дальше
    throw e
} catch (e: Exception) {
    // обрабатываем другие исключения
}</code></pre><p id="b9905055-9c97-4997-a809-b44e62b22da6" class="">
</p><h3 id="c054e767-2104-4ff9-9fc5-23689cf7d4b6" class=""><code><strong>CoroutineExceptionHandler</strong></code></h3><p id="a059ce41-4c8c-4b66-8457-32545f6fc820" class="">Определить поведение для всех необработанных исключений, которые происходят в текущем контексте выполнения корутин. Общий catch-блок. Если исключение захвачено, то дальше к родителю оно пробрасываться не будет. Под капотом <code>Thread.uncatchExceptionHandler</code>.</p><p id="2910fceb-162d-495b-ba14-9be3e7a53d7d" class="">• вызывается в последнюю очередь, когда произошла ошибка. на момент вызова корутина завершена.</p><p id="0d8a50e4-e666-4f83-b7a7-dd8a614112ea" class="">• может быть вызван на любом потоке. переопределять <code>Dispatchers.Main</code> если обновляем UI.</p><p id="93541054-9584-4f87-b859-fba6788c166e" class="">• не будет ловить <code>CancellationException</code> так как они не являются ошибками выполнения корутин.</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="561cdf61-24bc-4192-bcc5-e8ad159a0837" class="code"><code class="language-Kotlin" style="white-space:pre-wrap;word-break:break-all">val exceptionHandler = CoroutineExceptionHandler { coroutineContext, throwable -&gt;
    withContext(Dispatchers.Main) {
		    view.showError()
    }
}
CoroutineScope(exceptionHandler)
scope.launch(exceptionHandler)</code></pre><p id="aec1b8ba-8efe-4096-b9d3-a958ed872797" class="">
</p><h3 id="9d0169a8-ad36-42a4-a97d-6a1db3c07a42" class=""><code><strong>NonCancellable</strong></code></h3><p id="a986f414-d9f9-4b9b-93fa-42df0e60fe1f" class="">Использовать для освобождения ресурсов при исключении<br/> • только для использования в withContext()<br/></p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="34cf0f4c-b641-48e9-9e97-6884b4f1dc56" class="code"><code class="language-Kotlin" style="white-space:pre-wrap;word-break:break-all">val inputStream: InputStream
try {
    doSomethingLong(inputStream)
} catch (e: Exception) {
    // обрабатываем исключение
} finally {
    withContext(NonCancellable) {
        shutdown(inputStream)
    }
}</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="32238513-4c95-4310-9a42-4800cfb894bd" class="code"><code class="language-Kotlin" style="white-space:pre-wrap;word-break:break-all">try {
    coroutineScope {
        ...
    }
} catch (e: Exception) {
    // обработать все исключения scope
}</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="a851dd4a-77d9-4d64-821b-6221e91d80f9" class="code"><code class="language-Kotlin" style="white-space:pre-wrap;word-break:break-all">/**
 * Не вызывается в случае CancelException и если исключение произошло до задания CompletionHandler
 */
job.invokeOnCompletion { cause: Throwable? -&gt;
    if (cause != null) {
        // произошла ошибка
    } else {
        // корутина успешно выполнена
    }
}</code></pre></div></details><details open=""><summary style="font-weight:600;font-size:1.25em;line-height:1.3;margin:0"><code><strong>suspend</strong></code></summary><div class="indented"><p id="10315285-0ae8-8017-bb00-cde53e93a32e" class="">Используется для обозначения функций, которые могут быть приостановлены и возобновлены в будущем. Такие функции могут выполнять асинхронные задачи и могут вызываться только из других <code>suspend</code>-функций или корутин. Это позволяет эффективно управлять асинхронными операциями без блокировки потоков. Такие функции могут использовать функции-расширения корутин, например, <code>delay</code>, <code>withContext</code> и другие, для работы с асинхронными задачами.</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="10315285-0ae8-807c-bae8-c8d4e387d28e" class="code"><code class="language-Kotlin">// Определение suspend-функции
suspend fun doWork() {
    delay(1000L) // Приостанавливает выполнение на 1 секунду
    println(&quot;Work done!&quot;)
}

fun main() = runBlocking { // Запускает корутину
    launch {
        doWork() // Вызов suspend-функции внутри корутины
    }
    println(&quot;Starting work...&quot;)
}</code></pre><p id="10315285-0ae8-80d7-a4bc-dae02135ce39" class="">
</p><h3 id="10315285-0ae8-804c-94d8-e66eff6af455" class=""><code>Continuation</code></h3><p id="30b355da-95d9-4be8-bd24-89d66d5e8e3b" class="">Когда <code>suspend</code>-функция вызывается, она получает объект <code>Continuation</code>, который управляет состоянием функции и её продолжением. <code>Continuation</code> хранит информацию о том, где нужно продолжить выполнение после приостановки.</p><p id="10315285-0ae8-8043-800d-d6b89f9c8686" class="">При выполнении <code>suspend</code>-функции, выполнение может быть приостановлено в точке, где происходит вызов другой приостановленной функции или задержка (<code>delay</code>). Этот процесс преобразует функцию в корутину, которая работает асинхронно и может быть возобновлена позже.</p><p id="10315285-0ae8-8035-a39e-e6d5612b6c29" class="">Состояние функции (например, локальные переменные и текущее положение) сохраняется в объекте <code>Continuation</code>. Когда функция приостанавливается, состояние сохраняется, и выполнение возобновляется с этого состояния, когда корутина продолжает выполнение.</p><p id="10315285-0ae8-808b-addc-e119bc465a04" class="">Когда suspend функция возобновляется, объект <code>Continuation</code> используется для продолжения выполнения с точки, на которой функция была приостановлена. Это позволяет функции продолжить выполнение, как если бы она никогда не была приостановлена.</p></div></details><details open=""><summary style="font-weight:600;font-size:1.25em;line-height:1.3;margin:0"><code>suspendCoroutine</code></summary><div class="indented"><p id="cf459cbe-f183-40cc-8ff8-5fac8fa16aea" class="">Позволяет интегрировать некорутинный код (например, использующий коллбэки) с корутинами.</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="1f3044db-1b18-497f-88db-f780cae61eeb" class="code"><code class="language-Kotlin">// Пример callback hell — когда асинхронные вызовы вложены друг в друга, что делает код сложным для чтения и сопровождения
fun fetchData(callback: (String) -&gt; Unit) {
    getNetworkData { result1 -&gt;
        getDatabaseData(result1) { result2 -&gt;
            processResult(result2) { finalResult -&gt;
                callback(finalResult)
            }
        }
    }
}

// Пример того, как можно обернуть колбэки с помощью suspendCoroutine
suspend fun fetchData(): String = suspendCoroutine { continuation -&gt;
    getNetworkData { result1 -&gt;
        getDatabaseData(result1) { result2 -&gt;
            processResult(result2) { finalResult -&gt;
                // Возвращаем результат через continuation.resume
                continuation.resume(finalResult)
            }
        }
    }
}

// Идеальное решение
suspend fun fetchData(): String {
    val networkData = getNetworkDataAsync()
    val databaseData = getDatabaseDataAsync(networkData)
    return processResultAsync(databaseData)
}</code></pre></div></details><details open=""><summary style="font-weight:600;font-size:1.25em;line-height:1.3;margin:0"><code><strong>runBlocking</strong></code></summary><div class="indented"><p id="10315285-0ae8-8039-9a50-d517f46ede1e" class="">Функция, которая запускает корутину и блокирует текущий поток до ее завершения. Она используется для запуска корутин в обычном коде, например, в функциях main или в тестах. Выполняется в контексте вызывающего потока. Функция <code>runBlocking</code> синхронно ожидает завершения всех корутин внутри нее. Внутри <code>runBlocking</code> можно использовать другие корутины и функции, такие как <code>launch</code> и <code>async</code>, для выполнения асинхронных задач.</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="002f67ea-bb1e-41ce-87a7-0791d85dd327" class="code"><code class="language-Kotlin">fun main() = runBlocking { // Запускает корутину и блокирует текущий поток
    // Запускает другую корутину внутри runBlocking
    launch {
        delay(1000L)
        println(&quot;World&quot;)
    }
    println(&quot;Hello&quot;)
}</code></pre></div></details><details open=""><summary style="font-weight:600;font-size:1.25em;line-height:1.3;margin:0"><code>runCatching</code></summary><div class="indented"><p id="10315285-0ae8-8001-9676-c5535a5ce0e6" class="">Функция, которая используется для выполнения блока кода и обработки возможных исключений. Она возвращает результат выполнения блока в виде объекта <code>Result</code>, который упрощает работу с результатами и ошибками. Позволяет избежать использования конструкции <code>try-catch</code>. Предоставляет методы, такие как <code>getOrNull()</code> и <code>getOrElse()</code>, для удобного извлечения результата или обработки ошибки.</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="10315285-0ae8-807d-be03-e816b9a60277" class="code"><code class="language-Kotlin">fun main() {
    // Выполнение блока кода и получение результата в виде объекта Result
    val result: Result&lt;Int&gt; = runCatching {
        // Код, который может вызвать исключение
        &quot;123&quot;.toInt()
    }

    // Получение результата или обработки ошибки
    val value: Int? = result.getOrNull() // Возвращает значение, если не было исключения
    val error: Throwable? = result.exceptionOrNull() // Возвращает исключение, если оно произошло

    println(&quot;Value: $value&quot;) // Выводит: Value: 123
    println(&quot;Error: $error&quot;) // Выводит: Error: null (поскольку исключение не произошло)
}</code></pre></div></details><details open=""><summary style="font-weight:600;font-size:1.25em;line-height:1.3;margin:0"><code><strong>CoroutineName</strong></code></summary><div class="indented"><p id="10315285-0ae8-80a1-9429-c0df77822502" class="">Позволяет назначить уникальное имя корутине для удобства отладки. Используется для улучшения читаемости логов и диагностики, помогая легче отслеживать корутины в процессе их выполнения. Отображается в Android Studio Profiler. Не влияет на логику выполнения корутины и не изменяет ее поведение.</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="b1402985-486a-4594-bf2e-50b890604dd9" class="code"><code class="language-Kotlin" style="white-space:pre-wrap;word-break:break-all">// Создание корутины с именем
val job = CoroutineScope(Dispatchers.Default + CoroutineName(&quot;MyCoroutine&quot;)).launch {
    // Your coroutine code here
}</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="10315285-0ae8-80b5-ab98-dded4b244f67" class="code"><code class="language-Kotlin">// При создании вложенных корутин имя будет унаследовано от родительской корутины.
val job = CoroutineScope(Dispatchers.Default + CoroutineName(&quot;ParentCoroutine&quot;)).launch {
    launch(CoroutineName(&quot;ChildCoroutine&quot;)) {
        // Child coroutine code here
    }
}</code></pre></div></details><details open=""><summary style="font-weight:600;font-size:1.25em;line-height:1.3;margin:0"><mark class="highlight-purple">Kotlin Coroutines. Вопросы на собесе</mark></summary><div class="indented"><ol type="1" id="f679a9c9-1254-4201-b99e-8c94cf447d55" class="numbered-list" start="1"><li>Что такое корутины в котлине? Для чего они нужны?</li></ol><ol type="1" id="47455113-fff6-4f60-938f-b75b50df79c9" class="numbered-list" start="2"><li>Для чего нужно ключевое слово suspend?</li></ol><ol type="1" id="0720f5ce-f792-4316-be84-3bc9b5791a04" class="numbered-list" start="3"><li>Во что под капотом разворачивается suspend-функция?</li></ol><ol type="1" id="930f92c6-9d5d-4339-a6fb-8c50edbcae47" class="numbered-list" start="4"><li>Для чего используются каждый из диспетчеров?</li></ol><ol type="1" id="d6a00fa2-adb8-4556-a269-fa94623d2e67" class="numbered-list" start="5"><li>Как в корутинах работает структурированный параллелизм (structure cuncurrency)?</li></ol><ol type="1" id="afe0b570-b84e-4434-a75e-f830abfdea20" class="numbered-list" start="6"><li>Как в корутинах работает backpressure?</li></ol><ol type="1" id="4d936077-5023-4d71-b073-1023b4eaae79" class="numbered-list" start="7"><li>Как в корутинах запустить горячий и холодный потоки?</li></ol><ol type="1" id="2e25d59e-a2ca-4176-bffb-14c1ad443cf4" class="numbered-list" start="8"><li>Как не отменять корутину если один из ее дочерних элементов вышел из строя?</li></ol><ol type="1" id="09fbed59-8ea7-429b-80ed-f70a13756dd6" class="numbered-list" start="9"><li>Разница между coroutineScope и supervisorScope?</li></ol><ol type="1" id="82cc12c5-5353-4d92-b88a-f3acfa98f844" class="numbered-list" start="10"><li>Чем Dispatchers.Main отличается от Dispatchers.Main.immediate?</li></ol><ol type="1" id="10515285-0ae8-803d-bf22-fa428b3c6e06" class="numbered-list" start="11"><li>Из чего состоит контекст корутины?<p id="10515285-0ae8-8004-a547-f1fd72180c1c" class="">• <mark class="highlight-teal"><code>CoroutineDispatcher</code></mark><mark class="highlight-teal"> - определяет поток или диспетчер, на котором будет выполняться корутина.</mark></p><p id="10515285-0ae8-80d3-98d1-f638109329b6" class="">• <mark class="highlight-teal"><code>CoroutineName</code></mark><mark class="highlight-teal"> - устанавливает имя для отладки.</mark></p><p id="d53aedfd-eacb-420f-8f8c-480ce961d90c" class="">• <mark class="highlight-teal"><code>CoroutineExceptionHandler</code></mark><mark class="highlight-teal"> - для обработки исключений.</mark></p><p id="10515285-0ae8-80b9-a4ed-cd72f1b79cc6" class="">• <mark class="highlight-teal"><code>Job</code></mark><mark class="highlight-teal"> - управляет жизненным циклом корутины.</mark></p><p id="10515285-0ae8-8037-a19e-ef3c793a805d" class="">• <mark class="highlight-teal"><code>SupervisorJob</code></mark><mark class="highlight-teal"> - обеспечить более гибкое управление ошибками и отменой корутин.</mark></p></li></ol><ol type="1" id="10315285-0ae8-8091-a749-c5e7faf781b3" class="numbered-list" start="12"><li>Чем корутины отличаются от обычных потоков?<p id="8126d343-3aa1-470b-b535-464c6b8d49fb" class=""><mark class="highlight-teal">Отличаются тем, что они легковесны, не блокируют потоки при переключении контекста, позволяют писать асинхронный код в синхронном стиле и интегрируются с механизмами управления жизненным циклом для более эффективного управления задачами.</mark></p></li></ol><ol type="1" id="10315285-0ae8-801b-b49f-cb215926fe6c" class="numbered-list" start="13"><li>Чем Thread.sleep отличается от delay?<p id="10315285-0ae8-809d-b073-f9a907343eba" class=""><mark class="highlight-teal"><code>Thread.sleep</code></mark><mark class="highlight-teal"> блокирует текущий поток, тогда как </mark><mark class="highlight-teal"><code>delay</code></mark><mark class="highlight-teal"> приостанавливает выполнение корутины, освобождая поток для других задач.</mark></p></li></ol><ol type="1" id="a0351216-cf8f-4fdf-8e4a-2438b14250cd" class="numbered-list" start="14"><li>Какие есть способы синхронизировать корутины?<p id="10215285-0ae8-80fb-9d5b-e3239c522b23" class=""><mark class="highlight-teal"><code>Mutex</code></mark><mark class="highlight-default">,</mark><mark class="highlight-teal"> </mark><mark class="highlight-teal"><code>Atomic</code></mark><mark class="highlight-default">,</mark><mark class="highlight-teal"> </mark><mark class="highlight-teal"><code>limitedParallelism(1)</code></mark></p></li></ol><ol type="1" id="10215285-0ae8-8021-80fc-d4804c5a68fd" class="numbered-list" start="15"><li>Как обрабатывать исключения в корутинах?<p id="10215285-0ae8-8092-8f65-e4517d1147bd" class=""><mark class="highlight-teal">Исключения в корутинах можно обрабатывать с помощью </mark><mark class="highlight-teal"><code>try-catch</code></mark><mark class="highlight-teal">, </mark><mark class="highlight-teal"><code>CoroutineExceptionHandler</code></mark><mark class="highlight-teal"> для необработанных исключений, и </mark><mark class="highlight-teal"><code>SupervisorJob</code></mark><mark class="highlight-teal"> для изоляции исключений в дочерних корутинах.</mark></p></li></ol><ol type="1" id="10215285-0ae8-8002-b0ee-d9453541b46d" class="numbered-list" start="16"><li>Что нужно учитывать при обработки ошибок через try-catch в корутинах?<p id="10215285-0ae8-80c5-b42b-f41d4fb5f4b8" class=""><mark class="highlight-teal">При обработке ошибок через </mark><mark class="highlight-teal"><code>try-catch</code></mark><mark class="highlight-teal"> в корутинах нужно учитывать, что исключения (</mark><mark class="highlight-teal"><code>CancellationException</code></mark><mark class="highlight-teal">), возникшие в корутинах, могут отменить корутину, и </mark><mark class="highlight-teal"><code>try-catch</code></mark><mark class="highlight-teal"> работает только в пределах текущего контекста корутины.</mark></p></li></ol><ol type="1" id="10215285-0ae8-8058-ab68-e0a0a2fbf512" class="numbered-list" start="17"><li>Если передать CoroutineExceptionHandler в async, как обработается исключение?<p id="36d63d34-3646-45ce-a606-66c127cf4cf8" class=""><mark class="highlight-teal">Корутина выполнится, исключение будет в </mark><mark class="highlight-teal"><code>Deferred</code></mark><mark class="highlight-teal">.</mark></p></li></ol><ol type="1" id="10215285-0ae8-80f7-b27c-f52e6fe91499" class="numbered-list" start="18"><li>Как отменить корутину?<p id="43c23f40-1e8a-418c-a1b1-64a55bff8e59" class=""><mark class="highlight-teal">Методом </mark><mark class="highlight-teal"><code>cancel()</code></mark><mark class="highlight-teal"> </mark></p></li></ol><ol type="1" id="10215285-0ae8-80df-b1dd-e59075117054" class="numbered-list" start="19"><li>Какое поведение у корутины при вызове метода cancel?<p id="10215285-0ae8-806c-ae67-caf8c06ed98f" class=""><mark class="highlight-teal">При вызове метода </mark><mark class="highlight-teal"><code>cancel</code></mark><mark class="highlight-teal"> корутина помечается как </mark><mark class="highlight-teal"><code>Cancelled</code></mark><mark class="highlight-teal">, и её выполнение прекращается при следующем проверке на отмену.</mark></p></li></ol><ol type="1" id="633fe583-7439-40eb-93be-85dc48f9e999" class="numbered-list" start="20"><li>Как корутина понимает что она отменена?<p id="5fce1048-f78d-43b0-96e0-c7374e90e9b4" class=""><mark class="highlight-teal">Корутина понимает, что она отменена, когда проверяет состояние своей </mark><mark class="highlight-teal"><code>Job</code></mark><mark class="highlight-teal"> или когда происходит вызов метода </mark><mark class="highlight-teal"><code>isActive</code></mark><mark class="highlight-teal">. Отмена сигнализируется выбросом исключения </mark><mark class="highlight-teal"><code>CancellationException</code></mark><mark class="highlight-teal">, которое корутина может поймать и обработать, если это предусмотрено.</mark></p></li></ol><ol type="1" id="10215285-0ae8-8093-a2c7-d3bfe6abe63e" class="numbered-list" start="21"><li>Для чего нужен Job?<p id="412becd8-78b7-4470-8733-144b9bbd8d0c" class=""><mark class="highlight-teal">Управляет временем жизни корутины и позволяет отменить ее выполнение, а также отслеживать ее статус.</mark></p></li></ol><ol type="1" id="10515285-0ae8-8059-9f57-df0910d07d39" class="numbered-list" start="22"><li>Для чего нужен SupervisorJob?<p id="10515285-0ae8-80d7-af79-d27c24ed82eb" class=""><mark class="highlight-teal">Используется для управления иерархией корутин, позволяя дочерним корутинам завершаться независимо — сбой одной корутины не отменяет остальных.</mark></p></li></ol><ol type="1" id="10215285-0ae8-80f4-ae32-e1e783b8d11d" class="numbered-list" start="23"><li>Что такое scope в корутинах?<p id="7c602d21-6bdf-468c-826b-38c8b70fb50d" class=""><mark class="highlight-teal">Scope в корутинах управляет областью выполнения корутин, их временем жизни и отменой, обеспечивая контекст для запуска и управления корутинами.</mark></p></li></ol><ol type="1" id="10215285-0ae8-809d-a8b6-e6c82189f75e" class="numbered-list" start="24"><li>Как переключить контекст выполнения корутины?<p id="e8611ccf-d244-422c-a51b-ac348f0e8c5f" class=""><mark class="highlight-teal">Через </mark><mark class="highlight-teal"><code>withContext</code></mark><mark class="highlight-teal">.</mark></p></li></ol><ol type="1" id="10215285-0ae8-80f1-9bb7-de5469bef69d" class="numbered-list" start="25"><li>Что произойдет с корутиной при переключении с Dispatcher.Default на Dispathcer.IO?<p id="d593054f-e796-447c-ad0a-9b86dbef2189" class=""><mark class="highlight-teal">Если диспетчеры используют разные потоки, то фактически корутина будет перенесена на новый поток. Это происходит за счет переноса контекста и выполнения задачи на нужном пуле потоков. Переключение между диспетчерами требует переключения контекста, что может быть дорогой операцией, так как это связано с изменением потоков и управлением контекстом выполнения. Однако это меньше затраты по сравнению с созданием нового потока или корутины с нуля.</mark></p></li></ol><ol type="1" id="10515285-0ae8-80e9-bbfe-c3adfccefe35" class="numbered-list" start="26"><li>Как запустить корутину? (Какие существуют билдеры корутин)<p id="e630ac5a-8510-4089-9f36-e2b7286e669f" class=""><mark class="highlight-teal">С помощью билдеров корутин </mark><mark class="highlight-teal"><code>launch</code></mark><mark class="highlight-teal"> или </mark><mark class="highlight-teal"><code>async</code></mark><mark class="highlight-teal">.</mark></p></li></ol><ol type="1" id="10215285-0ae8-80d8-9d00-c98726efc30a" class="numbered-list" start="27"><li>Разница между launch и async?<p id="8b28dbb3-5efc-4134-8796-fad404283e91" class=""><mark class="highlight-teal"><code>launch</code></mark><mark class="highlight-teal"> запускает корутину без возврата результата и возвращает </mark><mark class="highlight-teal"><code>Job</code></mark><mark class="highlight-teal">, в то время как </mark><mark class="highlight-teal"><code>async</code></mark><mark class="highlight-teal"> также запускает корутину, но возвращает </mark><mark class="highlight-teal"><code>Deferred</code></mark><mark class="highlight-teal">, который используется для получения результата выполнения.</mark></p></li></ol><ol type="1" id="10515285-0ae8-801d-9144-d6002ce528b2" class="numbered-list" start="28"><li>Как дождаться выполнения launch?<p id="10515285-0ae8-8096-a010-cba4d8344844" class=""><mark class="highlight-teal">Использовать метод </mark><mark class="highlight-teal"><code>join()</code></mark><mark class="highlight-teal">. Он приостановит выполнение текущей корутины до завершения корутины, запущенной через launch.</mark></p></li></ol><ol type="1" id="10515285-0ae8-8080-bc44-f66f2f84ea98" class="numbered-list" start="29"><li>Как дождаться выполнения всех корутин в scope?<p id="88d81eb7-a5bd-4748-9f5d-9de76cc3ebd9" class=""><mark class="highlight-teal">Использовать метод </mark><mark class="highlight-teal"><code>joinAll()</code></mark><mark class="highlight-teal">.</mark></p></li></ol><ol type="1" id="f3102163-dfa2-4136-b84d-fd52f568ce8f" class="numbered-list" start="30"><li>Какие есть диспетчеры у корутин?<p id="65af1737-3ac2-4a75-b0ba-ac41687070b7" class=""><mark class="highlight-teal"><code>Dispatchers.Default</code></mark><mark class="highlight-teal"> </mark><mark class="highlight-teal"><code>Dispatchers.IO</code></mark><mark class="highlight-teal"> </mark><mark class="highlight-teal"><code>Dispatchers.Main</code></mark><mark class="highlight-teal"> </mark><mark class="highlight-teal"><code>Dispatcher.Main.immediate</code></mark><strong> </strong><mark class="highlight-teal"><code>Dispatchers.Unconfined</code></mark></p></li></ol><ol type="1" id="5b3362af-0ab6-4ebd-9d9a-47697c9befc3" class="numbered-list" start="31"><li>Можно ли вызвать suspend-функцию из Java-кода?<p id="9ce05756-7051-41b8-bdbe-9c3e6065ecfb" class=""><mark class="highlight-teal">Напрямую нет, но можно обернуть ее в </mark><mark class="highlight-teal"><code>runBlocking</code></mark><mark class="highlight-teal"> и таким образом вызвать.</mark></p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="10215285-0ae8-803b-a30f-e14876de4b39" class="code"><code class="language-Kotlin">// Это suspend-функция
suspend fun suspendFunction(): String {
    delay(1000)
    return &quot;Hello from suspend function!&quot;
}

// Это функция, которая оборачивает suspend-функцию и делает её доступной для Java-кода
fun callSuspendFunction(): String {
    return runBlocking {
        suspendFunction()
    }
}</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="74bea4fa-f697-44b4-bca2-700387de42a8" class="code"><code class="language-Java">public class Main {
    public static void main(String[] args) {
        // Вызов функции из Java-кода
        String result = KotlinCode.callSuspendFunction();
        System.out.println(result); // Выведет: Hello from suspend function!
    }
}</code></pre></li></ol><ol type="1" id="7a1c6380-9e28-403c-b73b-2c7f40a204a6" class="numbered-list" start="32"><li>Каких диспатчеров не существует?<p id="10215285-0ae8-8081-954b-f2192b4b6cda" class="">• <mark class="highlight-teal"><code>Default</code></mark></p><p id="10215285-0ae8-80cc-86da-e9ceada87024" class="">• <mark class="highlight-red">Computation</mark></p><p id="10215285-0ae8-80fb-80d5-d169a35be8b9" class="">• <mark class="highlight-teal"><code>IO</code></mark></p><p id="10215285-0ae8-8034-836e-d4a58138ab15" class="">• <mark class="highlight-teal"><code>Unconfined</code></mark></p><p id="10215285-0ae8-8030-983c-e69e1acbfa85" class="">• <mark class="highlight-red">Single</mark></p></li></ol><ol type="1" id="a460f680-6d11-4b4c-af8f-b89cb7b5e071" class="numbered-list" start="33"><li>Какой метод используется для запуска coroutine в пределах существующей coroutine, ожидая ее завершения?<p id="0645db41-5039-4200-b00a-d8bea816170e" class="">• <mark class="highlight-teal"><code>withContext</code></mark></p><p id="f1c71ad1-b4dc-4fac-98d3-15e272668d50" class="">• <mark class="highlight-red"><code>async</code></mark></p><p id="1b819d32-35e3-4265-a59e-574633576476" class="">• <mark class="highlight-red"><code>await</code></mark></p><p id="b1c9dd44-acf4-4a73-b6a0-1fee1f31e0fd" class="">• <mark class="highlight-red"><code>launch</code></mark></p></li></ol><ol type="1" id="3364ae78-b7f0-4f5b-b690-a82b634e54e0" class="numbered-list" start="34"><li>Какой метод используется для выполнения coroutine в главном потоке UI в Android?<p id="4f45de94-f762-4ab5-a54c-49bea3b74514" class="">• <mark class="highlight-red">withMainThread</mark></p><p id="916df192-bf4d-47d0-8d55-3968c4084e8e" class="">• <mark class="highlight-teal"><code>withContext(Dispatchers.Main)</code></mark></p><p id="90f35961-0a2d-43a9-b1cc-d5efe712d3e3" class="">• <mark class="highlight-red">withUl</mark></p><p id="d8715a95-e48b-4e1d-b3bc-fe138e5f1d14" class="">• <mark class="highlight-red">runOnUl</mark></p></li></ol><ol type="1" id="10215285-0ae8-800f-a587-ec5e03f249a8" class="numbered-list" start="35"><li>Какой тип coroutine контекста предназначен для задач, требующих значительных вычислительных ресурсов?<p id="e4fd7d6b-5cf4-4dc6-97e8-8464a6a5a84d" class="">• <mark class="highlight-red"><code>Dispatchers.IO</code></mark></p><p id="21445aae-291f-4ea7-ae43-bad45bf6ab97" class="">• <mark class="highlight-red"><code>Dispatchers.Computation</code></mark></p><p id="6e330a8f-48d3-401b-81ba-9cc972da891a" class="">• <mark class="highlight-red"><code>Dispatchers.Main</code></mark></p><p id="cbea6b12-e1ef-46b2-853a-7837156bb47f" class="">• <mark class="highlight-teal"><code>Dispatchers.Default</code></mark></p></li></ol><ol type="1" id="f036b097-13ae-4da9-8a17-fc081d16384a" class="numbered-list" start="36"><li>В каком случае выполнение будет параллельным, а в каком последовательным?<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="10415285-0ae8-801f-b8d3-c5bc413c8215" class="code"><code class="language-Kotlin">fun sum1(): Int {
		val a = async { suspendFun() }.await()
		val b = async { suspendFun() }.await()
		return a + b
}</code></pre><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="10415285-0ae8-80d4-bbdd-d5a013da7e4b" class="code"><code class="language-Kotlin">
fun sum2(): Int {
		val a = async { suspendFun() }
		val b = async { suspendFun() }
		return a.await() + b.await()
}</code></pre><p id="10415285-0ae8-806d-b584-cd06696a31c0" class="">• <mark class="highlight-teal"><strong>sum1</strong></mark><mark class="highlight-teal"> последовательно.</mark></p><p id="10415285-0ae8-809a-9507-c2bf19115ca9" class="">• <mark class="highlight-teal"><strong>sum2</strong></mark><mark class="highlight-teal"> параллельно.</mark></p></li></ol><ol type="1" id="10415285-0ae8-80d8-9445-e790d32bb2ba" class="numbered-list" start="37"><li>Что произойдет в обоих случаях, на каком этапе будет исключение?<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="10415285-0ae8-802a-8f32-fa9d42827075" class="code"><code class="language-Kotlin">fun someFun1() {
		val a: Int = async { suspendFun) }
}

fun someFun2() {
		launch { suspendFun() }
}

private fun suspendFun(): Int {
		throw RuntimeException)
}</code></pre><p id="10415285-0ae8-80ca-b9e6-d74876d34359" class="">• <mark class="highlight-teal">В </mark><mark class="highlight-teal"><strong>someFun1</strong></mark><mark class="highlight-teal"> исключение будет при вызове </mark><mark class="highlight-teal"><code>await</code></mark><mark class="highlight-teal"> в объекте </mark><mark class="highlight-teal"><code>Deferred</code></mark><mark class="highlight-teal">.</mark></p><p id="10415285-0ae8-8034-92bb-fcc1d7fbd18b" class="">• <mark class="highlight-teal">В </mark><mark class="highlight-teal"><strong>someFun2</strong></mark><mark class="highlight-teal"> исключение будет при запуске </mark><mark class="highlight-teal"><code>launch</code></mark><mark class="highlight-teal">.</mark></p></li></ol><ol type="1" id="245f643c-5011-425e-88c0-d461b12554d2" class="numbered-list" start="38"><li>Что произойдет при вызове данной функции?<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="10215285-0ae8-80c4-adc8-e7b55753b333" class="code"><code class="language-Kotlin">suspend fun unknownFunction() {
    coroutineScope {
        launch(Job()) {
            delay(1000)
            println(&quot;Hello!&quot;)
        }
        cancel()
    }
}</code></pre><p id="392c1a9f-bc66-460a-bd9c-7a871151ba3f" class="">• <mark class="highlight-red">Запустится корутина </mark><mark class="highlight-red"><code>launch</code></mark><mark class="highlight-red">, после задержки в 1 секунду, будет выведено &quot;Hello!&quot;, потом скоуп отменится.</mark></p><p id="10215285-0ae8-80da-ab47-f28bd550eeec" class="">• <mark class="highlight-red">Запустится корутина </mark><mark class="highlight-red"><code>launch</code></mark><mark class="highlight-red">, scope будет сразу же отменен, отменится корутина </mark><mark class="highlight-red"><code>launch</code></mark><mark class="highlight-red">, ничего выведено не будет.</mark></p><p id="10215285-0ae8-8049-866b-d0b56e4b26d9" class="">• <mark class="highlight-teal">Запустится корутина </mark><mark class="highlight-teal"><code>launch</code></mark><mark class="highlight-teal">, scope будет сразу же отменен, однако корутина </mark><mark class="highlight-teal"><code>launch</code></mark><mark class="highlight-teal"> продолжит свою работу, через секунду будет выведено &quot;Hello!&quot;.</mark></p><p id="10215285-0ae8-8090-9e5d-e3e7cf54e635" class="">• <mark class="highlight-red">Нет правильного ответа.</mark></p></li></ol></div></details></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>